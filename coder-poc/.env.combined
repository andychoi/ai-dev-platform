# Coder WebIDE PoC - Environment Configuration
# Copy this file to .env and customize as needed

# =============================================================================
# CODER SERVER CONFIGURATION
# =============================================================================

# Port for Coder web UI and API
CODER_PORT=7080

# External URL for accessing Coder (used for workspace connections)
# For local testing, use localhost
# For remote access, use your machine's IP or hostname
CODER_ACCESS_URL=http://host.docker.internal:7080

# Security settings (set to true in production with HTTPS)
CODER_SECURE_AUTH_COOKIE=false

# Session timeout (8h recommended for production, 24h for dev)
CODER_MAX_SESSION_EXPIRY=8h

# Rate limiting (set to false ONLY for local development)
CODER_RATE_LIMIT_DISABLE_ALL=false
CODER_RATE_LIMIT_API=512

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL password (change in production!)
POSTGRES_PASSWORD=coderpassword

# =============================================================================
# ADMIN USER (for setup script)
# =============================================================================

# Initial admin username
ADMIN_USER=admin

# Initial admin email
ADMIN_EMAIL=admin@local.test

# Initial admin password (change this!)
ADMIN_PASSWORD=SecureP@ssw0rd!

# =============================================================================
# DOCKER CONFIGURATION
# =============================================================================

# Docker group ID (usually auto-detected)
# Linux: Run `getent group docker | cut -d: -f3`
# Mac: Usually 999 or not needed
# DOCKER_GID=999

# =============================================================================
# OPTIONAL FEATURES
# =============================================================================

# Enable verbose logging (true/false)
# CODER_VERBOSE=false

# Disable telemetry (true/false)
# CODER_TELEMETRY=false

# Maximum session duration (e.g., 8h, 24h)
# CODER_MAX_SESSION_EXPIRY=24h

# =============================================================================
# AI GATEWAY CONFIGURATION
# Multi-provider AI API proxy for secure AI access from workspaces
# =============================================================================

# Anthropic Claude API
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=

# AWS Bedrock Configuration
# Requires IAM credentials with bedrock:InvokeModel permission
# SECURITY WARNING: Rotate these credentials when moving to production
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1

# Google Gemini API (planned)
# Get your API key from: https://makersuite.google.com/app/apikey
GOOGLE_API_KEY=

# AI Gateway Settings
# Rate limit: requests per minute per user
AI_RATE_LIMIT_RPM=60

# SECURITY: AI Gateway Authentication
# Set to false only for local development without auth
AI_GATEWAY_AUTH_ENABLED=false

# Shared secret for service-to-service auth (generate with: openssl rand -base64 32)
# AI_GATEWAY_AUTH_SECRET=

# Allowed CORS origins (comma-separated)
AI_GATEWAY_ALLOWED_ORIGINS=http://localhost:7080,http://host.docker.internal:7080

# DevDB password for AI Gateway
DEVDB_AI_GATEWAY_PASSWORD=aigateway123

# =============================================================================
# DRONE CI CONFIGURATION
# =============================================================================

# RPC secret for Drone server-runner communication
DRONE_RPC_SECRET=super-secret-rpc-key

# Drone server host (for webhook callbacks)
DRONE_SERVER_HOST=localhost:8080

# =============================================================================
# AUTHENTIK - Identity Provider & RBAC
# Provides SSO, user management, approval workflows
# =============================================================================

# Secret key for Authentik (generate with: openssl rand -base64 32)
AUTHENTIK_SECRET_KEY=change-me-to-a-long-random-string

# Authentik database password
AUTHENTIK_DB_PASSWORD=authentik

# Initial admin password for Authentik (user: akadmin)
AUTHENTIK_ADMIN_PASSWORD=admin

# =============================================================================
# AZURE AD INTEGRATION (Optional)
# Uncomment and configure to enable Azure AD SSO federation
# =============================================================================

# Azure AD Application (Client) ID
# AZURE_CLIENT_ID=

# Azure AD Client Secret
# AZURE_CLIENT_SECRET=

# Azure AD Tenant ID
# AZURE_TENANT_ID=

# =============================================================================
# TEST DATABASE CONFIGURATION
# =============================================================================

# Test database password (internal network only)
TESTDB_PASSWORD=testpassword

# =============================================================================
# DEVDB CONFIGURATION (Developer Database Server)
# =============================================================================

# DevDB admin password
DEVDB_ADMIN_PASSWORD=devdbadmin123

# =============================================================================
# PLATFORM ADMIN CONFIGURATION
# =============================================================================

# Platform Admin credentials
PLATFORM_ADMIN_USER=admin
PLATFORM_ADMIN_PASSWORD=admin123

# Coder admin credentials for Platform Admin to use
CODER_ADMIN_PASSWORD=CoderAdmin123!
# =============================================================================
# Authentik SSO Configuration
# Generated by setup-authentik-sso-full.sh
# Source this file or add to docker-compose environment
# =============================================================================

# Coder OIDC
CODER_OIDC_ISSUER_URL=http://authentik-server:9000/application/o/coder/
CODER_OIDC_CLIENT_ID=coder
CODER_OIDC_CLIENT_SECRET=wx9fQ6xRGJ51Ol3VxyAjngnRiJ4RR0FgNQP6wygfbOaPNc9h71WcLHOLuAPNwkhpNz0FaVUQ9iBtAKFZbIBemtTwy0FQxqmIcyXrcILgzC5DCCsoPRaD7PIYxCikOqzU
CODER_OIDC_ALLOW_SIGNUPS=true
CODER_OIDC_EMAIL_DOMAIN=
CODER_OIDC_SCOPES=openid,profile,email
CODER_DISABLE_PASSWORD_AUTH=false

# MinIO OIDC
MINIO_IDENTITY_OPENID_CONFIG_URL=http://authentik-server:9000/application/o/minio/.well-known/openid-configuration
MINIO_IDENTITY_OPENID_CLIENT_ID=minio
MINIO_IDENTITY_OPENID_CLIENT_SECRET=wHR4cvhFcRzVd985gIjwXyoceXwpCZMfRKVlMV6QFM27pma5Ue4MBFwRV5LJHCSdO8ux1XEih4MQ6pmP1TGOzWsBr7L3Mg2hTAfkHFJa6RUxATU20cuK1bc8y3NQRYq5
MINIO_IDENTITY_OPENID_CLAIM_NAME=policy
MINIO_IDENTITY_OPENID_SCOPES=openid,profile,email
MINIO_IDENTITY_OPENID_REDIRECT_URI=http://localhost:9001/oauth_callback

# Gitea OIDC (configure via Gitea Admin UI > Authentication Sources > Add OAuth2)
# Provider: OpenID Connect
# Auto Discovery URL: http://authentik-server:9000/application/o/gitea/.well-known/openid-configuration
GITEA_OIDC_CLIENT_ID=gitea
GITEA_OIDC_CLIENT_SECRET=MbUbgjBj8xB5QjBWIF0J5HmcR7zOWXNV7Zq36UZupLMgaw7RM74resi5fuxDiwaKY7JFeqBmV8rPsHVjeNgdem2FBQQShasPhrehryERXGFGAE8mMjqJvrhbN7Y1E1wJ
GITEA_OIDC_DISCOVERY_URL=http://authentik-server:9000/application/o/gitea/.well-known/openid-configuration

# Platform Admin OIDC
PLATFORM_ADMIN_OIDC_ISSUER_URL=http://authentik-server:9000/application/o/platform-admin/
PLATFORM_ADMIN_OIDC_CLIENT_ID=platform-admin
PLATFORM_ADMIN_OIDC_CLIENT_SECRET=QWRP11LMZ4B7Cn6GDj2hEOXR0r351aPG0xoWtNLP27CIV1Ivg7oikATXCjDEg3a9qQqePiHXMDgUwUuh9soGzKKh4buTBMI3WFYlAaGV6AWkXDm1q6jeP4K7gvFIzzT4

